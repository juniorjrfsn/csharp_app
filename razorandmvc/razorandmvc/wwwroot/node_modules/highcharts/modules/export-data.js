/*
 Highcharts JS v10.2.1 (2022-09-19)

 Exporting module

 (c) 2010-2021 Torstein Honsi

 License: www.highcharts.com/license
*/
(function(a){"object"===typeof module&&module.exports?(a["default"]=a,module.exports=a):"function"===typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(q){a(q);a.Highcharts=q;return a}):a("undefined"!==typeof Highcharts?Highcharts:void 0)})(function(a){function q(a,d,c,x){a.hasOwnProperty(d)||(a[d]=x.apply(null,c),"function"===typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:d,module:a[d]}})))}
a=a?a._modules:{};q(a,"Extensions/ExportData/ExportDataDefaults.js",[],function(){"";return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",
hideData:"Hide data table"}}});q(a,"Extensions/DownloadURL.js",[a["Core/Globals.js"]],function(a){var d=a.isSafari,c=a.win,x=c.document,q=c.URL||c.webkitURL||c,D=a.dataURLtoBlob=function(a){if((a=a.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/))&&3<a.length&&c.atob&&c.ArrayBuffer&&c.Uint8Array&&c.Blob&&q.createObjectURL){var g=c.atob(a[3]),r=new c.ArrayBuffer(g.length);r=new c.Uint8Array(r);for(var m=0;m<r.length;++m)r[m]=g.charCodeAt(m);a=new c.Blob([r],{type:a[1]});
return q.createObjectURL(a)}};a=a.downloadURL=function(a,q){var r=c.navigator,m=x.createElement("a");if("string"===typeof a||a instanceof String||!r.msSaveOrOpenBlob){a="".concat(a);r=/Edge\/\d+/.test(r.userAgent);if(d&&"string"===typeof a&&0===a.indexOf("data:application/pdf")||r||2E6<a.length)if(a=D(a)||"",!a)throw Error("Failed to convert to blob");if("undefined"!==typeof m.download)m.href=a,m.download=q,x.body.appendChild(m),m.click(),x.body.removeChild(m);else try{var g=c.open(a,"chart");if("undefined"===
typeof g||null===g)throw Error("Failed to open window");}catch(Q){c.location.href=a}}else r.msSaveOrOpenBlob(a,q)};return{dataURLtoBlob:D,downloadURL:a}});q(a,"Extensions/ExportData/ExportData.js",[a["Core/Renderer/HTML/AST.js"],a["Extensions/ExportData/ExportDataDefaults.js"],a["Core/Globals.js"],a["Core/DefaultOptions.js"],a["Extensions/DownloadURL.js"],a["Core/Series/SeriesRegistry.js"],a["Core/Utilities.js"]],function(a,q,c,x,W,P,g){function d(){var b=this.getCSV(!0);R(S(b,"text/csv")||"data:text/csv,\ufeff"+
encodeURIComponent(b),this.getFilename()+".csv")}function r(){var b='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+
this.getTable(!0)+"</body></html>";R(S(b,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+y.btoa(unescape(encodeURIComponent(b))),this.getFilename()+".xls")}function m(b){var a="",u=this.getDataRows(),e=this.options.exporting.csv,B=z(e.decimalPoint,","!==e.itemDelimiter&&b?(1.1).toLocaleString()[1]:"."),f=z(e.itemDelimiter,","===B?";":","),c=e.lineDelimiter;u.forEach(function(b,e){for(var h,t=b.length;t--;)h=b[t],"string"===typeof h&&(h='"'+h+'"'),"number"===typeof h&&"."!==B&&
(h=h.toString().replace(".",B)),b[t]=h;b.length=u.length?u[0].length:0;a+=b.join(f);e<u.length-1&&(a+=c)});return a}function D(b){var a=this.hasParallelCoordinates,u=this.time,e=this.options.exporting&&this.options.exporting.csv||{},c=this.xAxis,f={},w=[],q=[],K=[],h=this.options.lang.exportData,n=h.categoryHeader,g=h.categoryDatetimeHeader,r=function(a,f,u){if(e.columnHeaderFormatter){var l=e.columnHeaderFormatter(a,f,u);if(!1!==l)return l}return a?a instanceof X?b?{columnTitle:1<u?f:a.name,topLevelColumnTitle:a.name}:
a.name+(1<u?" ("+f+")":""):a.options.title&&a.options.title.text||(a.dateTime?g:n):n},T=function(a,b,f){var l={},u={};b.forEach(function(b){var e=(a.keyToAxis&&a.keyToAxis[b]||b)+"Axis";e=Y(f)?a.chart[e][f]:a[e];l[b]=e&&e.categories||[];u[b]=e&&e.dateTime});return{categoryMap:l,dateTimeValueAxisMap:u}},Z=function(a,b){return a.data.filter(function(a){return"undefined"!==typeof a.y&&a.name}).length&&b&&!b.categories&&!a.keyToAxis?a.pointArrayMap&&a.pointArrayMap.filter(function(a){return"x"===a}).length?
(a.pointArrayMap.unshift("x"),a.pointArrayMap):["x","y"]:a.pointArrayMap||["y"]},m=[],v,A=0;this.series.forEach(function(l){var t=l.xAxis,h=l.options.keys||Z(l,t),B=h.length,k=!l.requireSorting&&{},w=c.indexOf(t),n=T(l,h),d;if(!1!==l.options.includeInDataExport&&!l.options.isInternal&&!1!==l.visible){aa(m,function(a){return a[0]===w})||m.push([w,A]);for(d=0;d<B;)v=r(l,h[d],h.length),K.push(v.columnTitle||v),b&&q.push(v.topLevelColumnTitle||v),d++;var g={chart:l.chart,autoIncrement:l.autoIncrement,
options:l.options,pointArrayMap:l.pointArrayMap,index:l.index};l.options.data.forEach(function(b,c){var v={series:g};a&&(n=T(l,h,c));l.pointClass.prototype.applyOptions.apply(v,[b]);var p=v.x;L(f[p])&&f[p].seriesIndices.includes(g.index)&&(b=Object.keys(f).filter(function(a){return f[a].seriesIndices.includes(g.index)&&p}).filter(function(a){return 0===a.indexOf(String(p))}),p=p.toString()+","+b.length);b=l.data[c]&&l.data[c].name;d=0;if(!t||"name"===l.exportKey||!a&&t&&t.hasNames&&b)p=b;k&&(k[p]&&
(p+="|"+c),k[p]=!0);f[p]||(f[p]=[],f[p].xValues=[]);f[p].x=v.x;f[p].name=b;f[p].xValues[w]=v.x;L(f[p].seriesIndices)||(f[p].seriesIndices=[]);for(f[p].seriesIndices=E(E([],f[p].seriesIndices,!0),[g.index],!1);d<B;)c=h[d],b=v[c],f[p][A+d]=z(n.categoryMap[c][b],n.dateTimeValueAxisMap[c]?u.dateFormat(e.dateFormat,b):null,b),d++});A+=d}});for(d in f)Object.hasOwnProperty.call(f,d)&&w.push(f[d]);h=b?[q,K]:[K];for(A=m.length;A--;){var k=m[A][0];var M=m[A][1];var C=c[k];w.sort(function(a,b){return a.xValues[k]-
b.xValues[k]});var d=r(C);h[0].splice(M,0,d);b&&h[1]&&h[1].splice(M,0,d);w.forEach(function(a){var b=a.name;C&&!L(b)&&(C.dateTime?(a.x instanceof Date&&(a.x=a.x.getTime()),b=u.dateFormat(e.dateFormat,a.x)):b=C.categories?z(C.names[a.x],C.categories[a.x],a.x):a.x);a.splice(M,0,b)})}h=h.concat(w);N(this,"exportData",{dataRows:h});return h}function Q(a){var b=function(a){if(!a.tagName||"#text"===a.tagName)return a.textContent||"";var e=a.attributes,c="<".concat(a.tagName);e&&Object.keys(e).forEach(function(a){var b=
e[a];c+=" ".concat(a,'="').concat(b,'"')});c+=">";c+=a.textContent||"";(a.children||[]).forEach(function(a){c+=b(a)});return c+="</".concat(a.tagName,">")};a=this.getTableAST(a);return b(a)}function ba(a){var b=0,c=[],e=this.options,d=a?(1.1).toLocaleString()[1]:".",f=z(e.exporting.useMultiLevelHeaders,!0);a=this.getDataRows(f);var n=f?a.shift():null,g=a.shift(),m=function(a,b,c,f){var e=z(f,"");b="highcharts-text"+(b?" "+b:"");"number"===typeof e?(e=e.toString(),","===d&&(e=e.replace(".",d)),b="highcharts-number"):
f||(b="highcharts-empty");c=U({"class":b},c);return{tagName:a,attributes:c,textContent:e}};!1!==e.exporting.tableCaption&&c.push({tagName:"caption",attributes:{"class":"highcharts-table-caption"},textContent:z(e.exporting.tableCaption,e.title.text?e.title.text:"Chart")});for(var h=0,q=a.length;h<q;++h)a[h].length>b&&(b=a[h].length);c.push(function(a,b,c){var h=[],d=0;c=c||b&&b.length;var u=0,k;if(k=f&&a&&b){a:if(k=a.length,b.length===k){for(;k--;)if(a[k]!==b[k]){k=!1;break a}k=!0}else k=!1;k=!k}if(k){for(k=
[];d<c;++d){var t=a[d];var g=a[d+1];t===g?++u:u?(k.push(m("th","highcharts-table-topheading",{scope:"col",colspan:u+1},t)),u=0):(t===b[d]?e.exporting.useRowspanHeaders?(g=2,delete b[d]):(g=1,b[d]=""):g=1,t=m("th","highcharts-table-topheading",{scope:"col"},t),1<g&&t.attributes&&(t.attributes.valign="top",t.attributes.rowspan=g),k.push(t))}h.push({tagName:"tr",children:k})}if(b){k=[];d=0;for(c=b.length;d<c;++d)"undefined"!==typeof b[d]&&k.push(m("th",null,{scope:"col"},b[d]));h.push({tagName:"tr",
children:k})}return{tagName:"thead",children:h}}(n,g,Math.max(b,g.length)));var r=[];a.forEach(function(a){for(var c=[],e=0;e<b;e++)c.push(m(e?"td":"th",null,e?{}:{scope:"row"},a[e]));r.push({tagName:"tr",children:c})});c.push({tagName:"tbody",children:r});c={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:c}};N(this,"aftergetTableAST",c);return c.tree}function ca(){this.toggleDataTable(!1)}function da(b){(b=z(b,!this.isDataTableVisible))&&!this.dataTableDiv&&(this.dataTableDiv=
ea.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling));this.dataTableDiv&&(this.dataTableDiv.style.display=b?"block":"none",b&&(this.dataTableDiv.innerHTML=a.emptyHTML,(new a([this.getTableAST()])).addToDOM(this.dataTableDiv),N(this,"afterViewData",this.dataTableDiv)));this.isDataTableVisible=b;var c=this.exportDivElements,d=this.options.exporting,e=d&&d.buttons&&d.buttons.contextButton.menuItems;
b=this.options.lang;d&&d.menuItemDefinitions&&b&&b.viewData&&b.hideData&&e&&c&&(c=c[e.indexOf("viewData")])&&a.setElementHTML(c,this.isDataTableVisible?b.hideData:b.viewData)}function fa(){this.toggleDataTable(!0)}function S(a,c){var b=y.navigator,e=-1<b.userAgent.indexOf("WebKit")&&0>b.userAgent.indexOf("Chrome"),d=y.URL||y.webkitURL||y;try{if(b.msSaveOrOpenBlob&&y.MSBlobBuilder){var f=new y.MSBlobBuilder;f.append(a);return f.getBlob("image/svg+xml")}if(!e)return d.createObjectURL(new y.Blob(["\ufeff"+
a],{type:c}))}catch(w){}}function ha(){var a=this,c=a.dataTableDiv,d=document.querySelectorAll("thead")[0].querySelectorAll("tr")[0],e=function(a,b){return function(c,e){var d=(b?c:e).children[a].textContent;c=(b?e:c).children[a].textContent;return""===d||""===c||isNaN(d)||isNaN(c)?d.toString().localeCompare(c):d-c}};c&&d.childNodes.forEach(function(b){var d=b.closest("table");b.addEventListener("click",function(){var f=E([],c.querySelectorAll("tr:not(thead tr)"),!0),g=E([],b.parentNode.children,
!0);f.sort(e(g.indexOf(b),a.ascendingOrderInTable=!a.ascendingOrderInTable)).forEach(function(a){d.appendChild(a)});g.forEach(function(a){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(b){a.classList.contains(b)&&a.classList.remove(b)})});b.classList.add(a.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}function ia(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}
var E=this&&this.__spreadArray||function(a,c,d){if(d||2===arguments.length)for(var b=0,g=c.length,f;b<g;b++)!f&&b in c||(f||(f=Array.prototype.slice.call(c,0,b)),f[b]=c[b]);return a.concat(f||Array.prototype.slice.call(c))},ea=c.doc,y=c.win,ja=x.getOptions,O=x.setOptions,R=W.downloadURL,X=P.series;c=P.seriesTypes;var F=c.arearange,G=c.gantt,H=c.map,I=c.mapbubble,J=c.treemap,V=g.addEvent,L=g.defined,U=g.extend,aa=g.find,N=g.fireEvent,Y=g.isNumber,z=g.pick,n=[];"";return{compose:function(a){-1===n.indexOf(a)&&
(n.push(a),V(a,"afterViewData",ha),V(a,"render",ia),a=a.prototype,a.downloadCSV=d,a.downloadXLS=r,a.getCSV=m,a.getDataRows=D,a.getTable=Q,a.getTableAST=ba,a.hideData=ca,a.toggleDataTable=da,a.viewData=fa);if(-1===n.indexOf(O)){n.push(O);if(a=ja().exporting)U(a.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){this.toggleDataTable()}}}),
a.buttons&&a.buttons.contextButton.menuItems&&a.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData");O(q)}F&&-1===n.indexOf(F)&&(n.push(F),F.prototype.keyToAxis={low:"y",high:"y"});G&&-1===n.indexOf(G)&&(n.push(G),G.prototype.keyToAxis={start:"x",end:"x"});H&&-1===n.indexOf(H)&&(n.push(H),H.prototype.exportKey="name");I&&-1===n.indexOf(I)&&(n.push(I),I.prototype.exportKey="name");J&&-1===n.indexOf(J)&&(n.push(J),J.prototype.exportKey="name")}}});q(a,"masters/modules/export-data.src.js",
[a["Core/Globals.js"],a["Extensions/ExportData/ExportData.js"]],function(a,d){d.compose(a.Chart)})});
//# sourceMappingURL=export-data.js.map